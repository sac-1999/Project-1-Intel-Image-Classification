# -*- coding: utf-8 -*-
"""Fetch_Dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/19GWu9g1VVVeks-1jzEj_Jsl10NCucBrM
"""

from google.colab import drive
drive.mount('/content/drive')

import os
import pathlib
import tensorflow as tf
import glob
import pathlib

train_dir = pathlib.Path('/content/drive/MyDrive/Kaggle/seg_train/seg_train')
pred_dir =  pathlib.Path('/content/drive/MyDrive/Kaggle/seg_pred/seg_pred')
val_dir =  pathlib.Path('/content/drive/MyDrive/Kaggle/seg_test/seg_test')

def class_labels():
  label_dictionary = {0 : 'buildings',
  1 : 'forest',
  2 : 'glacier',
  3 : 'mountain',
  4 : 'sea',
  5 : 'street'} 

  return label_dictionary

def load_traindata(batch_size, image_size):
    train_ds = tf.keras.preprocessing.image_dataset_from_directory(train_dir,
                                                               labels='inferred',
                                                               label_mode='categorical',
                                                               image_size=image_size,
                                                               batch_size = batch_size)
    
    return train_ds

def load_valdata(batch_size, image_size):
    
    val_ds = tf.keras.preprocessing.image_dataset_from_directory(val_dir,
                                                               labels='inferred',
                                                               label_mode='categorical',
                                                               image_size=image_size,
                                                               batch_size = batch_size)
    

    return val_ds


def process(image,label):
    image = tf.cast(image/255. ,tf.float32)
    return image,label

